# Complex V (ATP Synthase) Analysis

**Location:** `03_Results/02_Analysis/Plots/Complex_V_analysis/`
**Generated by:** `02_Analysis/2.5.viz_complex_v_analysis.R`
**Last Updated:** 2025-12-04

---

## Overview

This directory contains focused analysis of ATP synthase (Complex V of the electron transport chain) gene expression and pathway enrichment. Complex V is of particular interest because:

1. DRP1 mutations affect mitochondrial dynamics and ATP production
2. ATP depletion may explain the translation crisis phenotype
3. Complex V represents the final step of oxidative phosphorylation

---

## Biological Background

### Complex V (ATP Synthase)

ATP synthase uses the proton gradient generated by Complexes I-IV to synthesize ATP:

```
              H+ gradient (from ETC)
                      |
    ADP + Pi --[Complex V]--> ATP
                      |
            Powers cellular processes
```

### Complex V Subunits

ATP synthase consists of two main sectors:

**F0 sector (membrane-embedded):**
- ATP5PB, ATP5MC1, ATP5MC2, ATP5MC3
- ATP5ME, ATP5MF, ATP5MG
- ATP5PD, ATP5PF, ATP5PO

**F1 sector (matrix-facing):**
- ATP5F1A (alpha), ATP5F1B (beta)
- ATP5F1C (gamma), ATP5F1D (delta)
- ATP5F1E (epsilon)

**Assembly factors:**
- ATPAF1, ATPAF2, TMEM70, DMAC2L, ATPSCKMT

---

## File Inventory

| File | Size | Description |
|------|------|-------------|
| `Complex_V_Gene_Expression_Heatmap.pdf` | ~8 KB | LogFC heatmap across trajectory stages (Early/TrajDev/Late) |
| `Complex_V_Pathway_Enrichment.pdf` | ~7 KB | GSEA enrichment dotplot for Complex V pathways |
| `Complex_V_Genes.csv` | ~180 B | Gene list extracted from GSEA core enrichment |
| `Complex_V_Pathway_Data.csv` | ~1.5 KB | Complete pathway enrichment statistics |

---

## Visualizations

### Complex V Gene Expression Heatmap

**File:** `Complex_V_Gene_Expression_Heatmap.pdf`

**What it shows:**
- Two side-by-side heatmaps: G32A (left) and R403C (right)
- Rows: Complex V genes (from GSEA core enrichment)
- Columns: Trajectory stages (Early, TrajDev, Late)
- Color: Log2 fold-change (logFC) values

**Column definitions:**
- **Early**: D35 mutation effect (G32A_vs_Ctrl_D35 or R403C_vs_Ctrl_D35)
- **TrajDev**: Mutation-specific maturation (Maturation_G32A_specific or Maturation_R403C_specific)
- **Late**: D65 mutation effect (G32A_vs_Ctrl_D65 or R403C_vs_Ctrl_D65)

**Color interpretation:**
- Blue: Downregulated (negative logFC)
- White: No change
- Red: Upregulated (positive logFC)

**Key observations:**
- Early suppression of Complex V genes in both mutations
- TrajDev shows recovery attempt
- Late outcome differs between mutations

### Complex V Pathway Enrichment

**File:** `Complex_V_Pathway_Enrichment.pdf`

**What it shows:**
- Dotplot of Complex V pathway enrichment across all contrasts
- Dot color: NES (Normalized Enrichment Score)
- Dot size: -log10(FDR)
- Black outline: FDR < 0.01

**Contrasts included:**
- G32A D35, R403C D35 (Early effects)
- G32A Maturation, R403C Maturation (TrajDev)
- G32A D65, R403C D65 (Late effects)
- Ctrl Time, G32A Time, R403C Time (Time effects)

**Pathways searched (MitoCarta keywords):**
- complex.*v, cv_, atp.*synth, atp5

---

## Data Files

### Complex_V_Genes.csv

List of Complex V genes extracted from GSEA core enrichment:

```csv
"Gene"
"ATP5F1B"
"ATP5F1C"
"ATPSCKMT"
"ATP5MF"
...
```

Note: Genes are dynamically extracted from significant pathway enrichments, not a predefined list.

### Complex_V_Pathway_Data.csv

Complete GSEA statistics for Complex V pathways:

| Column | Description |
|--------|-------------|
| Description | Original pathway name from MitoCarta |
| Pathway_Clean | Cleaned pathway name (title case) |
| Contrast | Comparison name |
| Mutation | G32A, R403C, or Control |
| Stage | Early (D35), Maturation, Late (D65), or Time Effect |
| NES | Normalized Enrichment Score |
| p.adjust | FDR-adjusted p-value |
| pvalue | Raw p-value |
| setSize | Number of genes in pathway |
| core_enrichment | Leading edge genes (slash-separated) |

---

## Key Findings

### Pathway Enrichment Summary

| Stage | Direction | Interpretation |
|-------|-----------|----------------|
| Early (D35) | Downregulated | Complex V suppressed in both mutations |
| Maturation | Upregulated | Compensatory increase during development |
| Late (D65) | Variable | Mutation-specific outcomes |

### Why Complex V is Most Vulnerable

1. Largest OXPHOS complex (28 subunits)
2. Requires both nuclear and mitochondrial gene expression
3. Assembly depends on proper mitochondrial positioning
4. Direct link to ATP production (final step of OXPHOS)
5. Most enrichments across all contrasts

---

## Generation Script

```r
# 02_Analysis/2.5.viz_complex_v_analysis.R

# Load checkpoints
mitocarta_gsea_results <- readRDS("checkpoints/mitocarta_gsea_results.rds")
fit <- readRDS("checkpoints/fit_object.rds")

# Search for Complex V pathways using keywords
complex_v_keywords <- c("complex.*v", "cv_", "atp.*synth", "atp5")

# Extract significant pathways (p.adjust < 0.05) and core enrichment genes
# for each contrast from MitoCarta GSEA results

# Create pathway enrichment dotplot
# - X-axis: Contrasts
# - Y-axis: Complex V pathways
# - Color: NES, Size: -log10(FDR)

# Create gene expression heatmap using ComplexHeatmap
# - Extract logFC from fit$coefficients for trajectory contrasts
# - Side-by-side: G32A (Early/TrajDev/Late) | R403C (Early/TrajDev/Late)
# - Color scale: logFC (-0.6 to 0.6)

# Export CSV files with pathway data and gene lists
```

---

## Related Analyses

### MitoCarta Pathways

Related pathways from MitoCarta analysis:
- OXPHOS
- Mitochondrial central dogma
- Mitochondrial protein import

See: `../GSEA/*/MitoCarta/`

### Mito Translation Cascade

Complex V is part of the broader cascade:
```
mtDNA --> mt-mRNA --> mt-ribosomes --> ETC complexes --> ATP --> translation
```

See: `../Mito_translation_cascade/`

---

## Related Documentation

- `../README.md` - Overall Plots directory
- `../Mito_translation_cascade/README.md` - Related cascade analysis
- `../GSEA/README.md` - Full pathway enrichment results
- `02_Analysis/2.5.viz_complex_v_analysis.R` - Generation script
