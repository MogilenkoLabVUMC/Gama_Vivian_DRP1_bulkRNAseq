# Calcium Signaling Gene Analysis

**Location:** `03_Results/02_Analysis/Calcium_genes/`
**Generated by:** `02_Analysis/viz_calcium_genes.R` (sourced from `1a.Main_pipeline.R`)
**Last Updated:** 2025-11-25

---

## Overview

This folder contains focused analysis of calcium signaling genes that are biologically relevant to DRP1 mutation phenotypes. Calcium dysregulation is hypothesized to link mitochondrial dysfunction to neuronal hyperexcitability and seizures.

---

## Biological Rationale

**Why calcium genes?**

DRP1 mutations affect mitochondrial dynamics, which impacts:
1. **Mitochondrial calcium buffering** - Mitochondria buffer cytosolic Ca2+
2. **ATP-dependent calcium pumps** - SERCA (ATP2A1) requires ATP
3. **Store-operated calcium entry** - STIM/ORAI pathway
4. **Neuronal excitability** - Calcium signaling underlies action potentials

---

## Target Gene Panel

| Gene | Function | Category |
|------|----------|----------|
| **NNAT** | Neuronatin - ER calcium regulation | ER/calcium |
| **CACNG3** | Calcium channel auxiliary subunit | Channel |
| **CACNA1S** | L-type calcium channel | Channel |
| **ATP2A1** | SERCA calcium ATPase | Pump |
| **RYR1** | Ryanodine receptor (calcium release) | Channel |
| **MYLK3** | Myosin light chain kinase | Kinase |
| **VDR** | Vitamin D receptor | Transcription |
| **STIM1** | Stromal interaction molecule 1 | SOCE |
| **STIM2** | Stromal interaction molecule 2 | SOCE |
| **ORAI1_1** | Calcium release-activated channel | SOCE |
| **CALB1** | Calbindin - calcium buffer | Buffer |
| **CALR** | Calreticulin - ER calcium buffer | Buffer |
| **PNPO** | Pyridoxine phosphate oxidase | Metabolism |

**Note:** CACNA1C, CASR, and ORAI1 were not detected in the dataset. ORAI1_1 is an alternative symbol.

---

## File Inventory

### Data Files

| File | Size | Description |
|------|------|-------------|
| `calcium_genes_DE_results.csv` | 16 KB | DE statistics for all calcium genes |

### Visualization Files

| File | Size | Contrast | Description |
|------|------|----------|-------------|
| `calcium_genes_boxplots.pdf` | 33 KB | All | Expression boxplots by condition |
| `calcium_genes_expression_heatmap.pdf` | 0 B | All | Expression heatmap (empty if insufficient variance) |
| `G32A_vs_Ctrl_D35_calcium_volcano.pdf` | 1.2 MB | G32A_vs_Ctrl_D35 | Volcano with calcium genes highlighted |
| `G32A_vs_Ctrl_D65_calcium_volcano.pdf` | 1.2 MB | G32A_vs_Ctrl_D65 | Volcano with calcium genes highlighted |
| `R403C_vs_Ctrl_D35_calcium_volcano.pdf` | 1.2 MB | R403C_vs_Ctrl_D35 | Volcano with calcium genes highlighted |
| `R403C_vs_Ctrl_D65_calcium_volcano.pdf` | 1.2 MB | R403C_vs_Ctrl_D65 | Volcano with calcium genes highlighted |
| `Time_Ctrl_calcium_volcano.pdf` | 1.2 MB | Time_Ctrl | Volcano with calcium genes highlighted |
| `Time_G32A_calcium_volcano.pdf` | 1.2 MB | Time_G32A | Volcano with calcium genes highlighted |
| `Time_R403C_calcium_volcano.pdf` | 1.2 MB | Time_R403C | Volcano with calcium genes highlighted |
| `Maturation_G32A_specific_calcium_volcano.pdf` | 1.2 MB | Interaction | Volcano with calcium genes highlighted |
| `Maturation_R403C_specific_calcium_volcano.pdf` | 1.2 MB | Interaction | Volcano with calcium genes highlighted |

---

## Data File Structure

### calcium_genes_DE_results.csv

| Column | Description |
|--------|-------------|
| gene | Gene symbol |
| contrast | Comparison name |
| logFC | Log2 fold-change |
| AveExpr | Average expression |
| t | Moderated t-statistic |
| P.Value | Raw p-value |
| adj.P.Val | FDR-adjusted p-value |
| B | B-statistic |
| significant | TRUE if adj.P.Val < 0.05 |

---

## Visualization Details

### Boxplots (calcium_genes_boxplots.pdf)

**What it shows:**
- Log2-CPM expression values for each calcium gene
- Grouped by genotype (Control, G32A, R403C)
- Colored by timepoint (D35, D65)

**Interpretation:**
- Compare expression levels across conditions
- Identify genes with mutation-specific effects
- Assess maturation changes

### Volcano Plots (*_calcium_volcano.pdf)

**What they show:**
- All genes as points (log2FC vs -log10 p-value)
- Calcium genes highlighted in red
- Labeled with gene names

**Key features:**
- Horizontal dashed line: p-value threshold (0.05)
- Vertical dashed lines: fold-change threshold (|log2FC| > 1)
- Red points: calcium gene panel

**Interpretation:**
- Genes in upper-left: significantly downregulated
- Genes in upper-right: significantly upregulated
- Red labels: calcium genes (whether significant or not)

### Expression Heatmap

**Note:** This file may be empty (0 bytes) if:
- Insufficient variance among calcium genes
- Too few genes detected
- Clustering failed

---

## Key Findings

### NNAT (Neuronatin)

- **Most significant calcium gene** in multiple contrasts
- Strongly downregulated in mutations (logFC ~ -4)
- Known regulator of ER calcium homeostasis
- Links to neurodevelopmental phenotypes

### STIM1/STIM2 (Store-Operated Calcium Entry)

- Modest changes in expression
- STIM1 trends toward upregulation
- May indicate compensatory calcium signaling

### Calcium Channels

- CACNG3: Variable effects by contrast
- CACNA1S: Low expression, limited changes
- RYR1: Mutation-specific effects

---

## Usage Examples

### R: Load and filter calcium results

```r
calcium <- read.csv("Calcium_genes/calcium_genes_DE_results.csv")

# Significant genes
sig_calcium <- calcium[calcium$significant == TRUE, ]

# Most changed gene
top_gene <- calcium[which.max(abs(calcium$logFC)), ]

# By contrast
g32a_d35 <- calcium[calcium$contrast == "G32A_vs_Ctrl_D35", ]
```

### R: Create custom calcium plot

```r
library(ggplot2)

# Plot logFC across contrasts
ggplot(calcium, aes(x = contrast, y = logFC, fill = gene)) +
  geom_bar(stat = "identity", position = "dodge") +
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
  labs(title = "Calcium Gene Expression Changes")
```

---

## Generation Script

The analysis is performed by `02_Analysis/viz_calcium_genes.R`, which is sourced from the main pipeline:

```r
# In 02_Analysis/1a.Main_pipeline.R
message("Running calcium gene analysis (separate script)...")
source(here::here("02_Analysis/viz_calcium_genes.R"))
```

### Script Logic

1. Load DE results from checkpoints
2. Filter to calcium gene panel
3. Generate boxplots of expression
4. Create volcano plots with highlighting
5. Attempt expression heatmap
6. Save DE statistics to CSV

### Configuration

Calcium genes are defined in the main pipeline config:

```r
config <- list(
  calcium_genes = c(
    "NNAT","CACNG3","CACNA1S","ATP2A1",
    "RYR1","MYLK3","VDR","STIM1","STIM2",
    "ORAI1_1","CALB1","CALR","PNPO"
  ),
  ...
)
```

---

## Relationship to Pathway Analysis

Calcium-related findings also appear in:

| Database | Pathway | Key Result |
|----------|---------|------------|
| Hallmark | CALCIUM_SIGNALING | Variable by contrast |
| GO:BP | calcium ion transport | Downregulated |
| GO:CC | endoplasmic reticulum | Mixed |
| Reactome | Calcium signaling | Downregulated |

See `Verification_reports/calcium_pathways_*.csv` for complete pathway-level analysis.

---

## Related Documentation

- `../README.md` - Main analysis overview
- `../Verification_reports/README.md` - Calcium pathway statistics
- `../Plots/Volcano/README.md` - General volcano plot documentation
- `02_Analysis/viz_calcium_genes.R` - Generation script
- `CLAUDE.md` - Calcium gene configuration
