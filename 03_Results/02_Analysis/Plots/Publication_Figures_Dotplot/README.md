# Publication_Figures_Dotplot

## Overview

This folder contains dotplot versions of the main publication figures. Dotplots encode statistical significance through dot size, making it easier to identify significant pathways compared to the original heatmap versions in the parent `Publication_Figures/` directory.

## Generating Script(s)

- `02_Analysis/3.2.publication_figures_dotplot.py` - Generates all dotplot publication figures

## Contents

### Figures

| File | Description | Generated By |
|------|-------------|-------------|
| `Fig1_Ribosome_Paradox_dotplot.pdf` | 3-panel dotplot showing ribosome paradox (biogenesis up, synaptic down, mito translation up) across trajectory stages | `3.2.publication_figures_dotplot.py` |
| `Fig1_Ribosome_Paradox_dotplot.png` | PNG version of ribosome paradox dotplot | `3.2.publication_figures_dotplot.py` |
| `Fig2_MitoCarta_Trajectory_Patterns_dotplot.pdf` | Dotplot of all MitoCarta pathways showing trajectory patterns (Early, TrajDev, Late) for G32A and R403C mutations | `3.2.publication_figures_dotplot.py` |
| `Fig2_MitoCarta_Trajectory_Patterns_dotplot.png` | PNG version of MitoCarta trajectory patterns dotplot | `3.2.publication_figures_dotplot.py` |
| `Fig3b_SynGO_Trajectory_Patterns_dotplot.pdf` | Dotplot of all SynGO pathways showing trajectory patterns across mutations | `3.2.publication_figures_dotplot.py` |
| `Fig3b_SynGO_Trajectory_Patterns_dotplot.png` | PNG version of SynGO trajectory patterns dotplot | `3.2.publication_figures_dotplot.py` |
| `Fig3_Pattern_Classification_Summary.pdf` | Bar chart showing distribution of pattern classifications (Compensation, Sign_reversal, Progressive, etc.) - identical to original | `3.2.publication_figures_dotplot.py` |
| `Fig3_Pattern_Classification_Summary.png` | PNG version of pattern classification bar chart | `3.2.publication_figures_dotplot.py` |
| `Fig4_Semantic_Pathway_Overview_dotplot.pdf` | Comprehensive dotplot of semantic pathway categories across all databases and contrasts | `3.2.publication_figures_dotplot.py` |
| `Fig4_Semantic_Pathway_Overview_dotplot.png` | PNG version of semantic pathway overview dotplot | `3.2.publication_figures_dotplot.py` |

### Documentation Files

| File | Description | Generated By |
|------|-------------|-------------|
| `README_DOTPLOT_VERSION.md` | Detailed documentation of dotplot implementation, advantages, and comparison with heatmap version | Manual |
| `LEGEND_IMPROVEMENTS.md` | Technical notes on size legend improvements and fixes (2025-11-25) | Manual |

## Dotplot Visual Encoding

Each dot in the dotplots encodes three pieces of information:

1. **Dot Color**: NES (Normalized Enrichment Score)
   - Blue = downregulated pathways (negative NES)
   - Orange = upregulated pathways (positive NES)
   - White = no enrichment (NES ≈ 0)
   - Uses colorblind-safe Blue-White-Orange diverging palette

2. **Dot Size**: Statistical significance (-log10(padj))
   - Larger dots = more significant (lower padj values)
   - Smaller dots = less significant (higher padj values)
   - Size range: 20-300 points
   - Visual size legend included in all figures

3. **Dot Edge**: Significance threshold indicator
   - Black outline (linewidth=2) = padj < 0.05 (significant)
   - Gray outline (linewidth=1) = padj ≥ 0.05 (not significant)

## Trajectory Framework

All figures follow the trajectory framework:
- **Early**: D35 mutation effects (G32A_vs_Ctrl_D35, R403C_vs_Ctrl_D35)
- **TrajDev**: Mutation-specific developmental trajectory changes (Maturation_G32A_specific, Maturation_R403C_specific)
- **Late**: D65 mutation effects (G32A_vs_Ctrl_D65, R403C_vs_Ctrl_D65)

## How to Regenerate

```bash
python3 02_Analysis/3.2.publication_figures_dotplot.py
```

**Dependencies:**
- Master GSEA table: `03_Results/02_Analysis/master_gsea_table.csv` (generated by `4.1.create_master_pathway_table.py`)
- Semantic categories: `01_Scripts/Python/semantic_categories.py`
- Pattern definitions: `01_Scripts/Python/pattern_definitions.py`
- DotplotRenderer class: `01_Scripts/RNAseq-toolkit/scripts/GSEA/GSEA_plotting_python/dotplot_renderer.py`

**Runtime:** ~30 seconds

## Advantages Over Heatmap Version

- **More intuitive**: Dot size immediately conveys significance level
- **Better visual clarity**: Dots don't bleed together like heatmap cells
- **Easier pattern recognition**: Large black-outlined dots (highly significant) stand out clearly
- **Publication-standard**: Dotplots are the standard visualization for pathway enrichment analysis

## Data Filtering

- CGP database excluded (cancer-focused, not relevant to neuronal analysis)
- Pathways must have ≥3 trajectory data points
- At least one significant result (padj < 0.05) required for pathway inclusion
- Same semantic categories and filtering criteria as heatmap version

## Technical Implementation

### New Components (2025-11-25)

1. **DotplotRenderer class**
   - Location: `01_Scripts/RNAseq-toolkit/scripts/GSEA/GSEA_plotting_python/dotplot_renderer.py`
   - Handles consistent dot size calculation: `min_size + (-log10(padj)/10) * (max_size - min_size)`
   - Manages edge color assignment based on significance threshold
   - Ensures dot sizes in legend match actual figure dots exactly

2. **Size Legend Improvements**
   - Fixed text overlap with increased horizontal spacing
   - Corrected dot sizes to match actual figure (no artificial scaling)
   - Increased legend area height for all figures
   - Clear visual examples at padj = 0.001, 0.01, 0.05, 0.1

## Comparison with Original Heatmaps

### Original Heatmap Version (Publication_Figures/)
- Color intensity encodes NES continuously
- Better for visualizing gradients across many pathways
- Emphasizes pattern continuity

### Dotplot Version (This Folder)
- Dot size encodes significance explicitly
- Better for identifying statistically significant pathways
- Easier to interpret in presentations
- Standard format for pathway enrichment publications

Both versions use identical:
- Data sources and filtering criteria
- Trajectory framework structure
- Pattern classifications
- Colorblind-safe color palette

## Related Visualizations

- **Publication_Figures/** - Original heatmap versions (main manuscript figures)
- **Ribosome_paradox/** - Core ribosome downregulation finding
- **Mito_translation_cascade/** - Mitochondrial translation cascade mechanistic visualization
- **Synaptic_ribosomes/** - Synaptic translation deep-dive analysis
- **Critical_period_trajectories/** - GSVA-based temporal trajectory analysis
- **Cross_database_validation/** - Cross-database pattern validation

## Notes

- All figures maintain aspect ratios optimized for publication
- PDF versions are vector graphics suitable for journal submission
- PNG versions (300 DPI) are suitable for presentations
- Size legend included in all dotplot figures for interpretability
- Pattern classification (Fig3) is identical between heatmap and dotplot versions as it's a bar chart

## File Sizes

```
Fig1_Ribosome_Paradox_dotplot.pdf         85K
Fig1_Ribosome_Paradox_dotplot.png        490K
Fig2_MitoCarta_Trajectory_Patterns_dotplot.pdf   72K
Fig2_MitoCarta_Trajectory_Patterns_dotplot.png  308K
Fig3b_SynGO_Trajectory_Patterns_dotplot.pdf     67K
Fig3b_SynGO_Trajectory_Patterns_dotplot.png    316K
Fig3_Pattern_Classification_Summary.pdf         48K
Fig3_Pattern_Classification_Summary.png        190K
Fig4_Semantic_Pathway_Overview_dotplot.pdf     152K
Fig4_Semantic_Pathway_Overview_dotplot.png    1.1M
```
